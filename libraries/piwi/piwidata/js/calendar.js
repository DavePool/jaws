var fixedX=-1;var fixedY=-1;var startAt=1;var showWeekNumber;var showToday=1;var imgDir="piwidata/art/calendar/";var monthName=new Array("January","February","March","April","May","June","July","August","September","October","November","December");var monthName2=new Array("JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC");if(startAt==0){dayName=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat")}else{dayName=new Array("Mon","Tue","Wed","Thu","Fri","Sat","Sun")}var clrdate="Clear Date";var gotoString="Go To Current Month";var todayString="Jump to today: ";var weekString="W";var scrollLeftMessage="Click to scroll to previous month. Hold mouse button to scroll automatically.";var scrollRightMessage="Click to scroll to next month. Hold mouse button to scroll automatically.";var selectMonthMessage="Click to select a month.";var selectYearMessage="Click to select a year.";var selectDateMessage="Select [date] as date.";var crossobj,crossMonthObj,crossYearObj,monthSelected,yearSelected,dateSelected,omonthSelected,oyearSelected,odateSelected,monthConstructed,yearConstructed,intervalID1,intervalID2,timeoutID1,timeoutID2,ctlToPlaceValue,ctlNow,dateFormat,nStartingYear;var bPageLoaded=false;var ie=document.all;var dom=document.getElementById;var ns4=document.layers;var today=new Date();var dateNow=today.getDate();var monthNow=today.getMonth();var yearNow=today.getYear();var imgsrc=new Array("drop1.gif","drop2.gif","left1.gif","left2.gif","right1.gif","right2.gif");var img=new Array();var bShow=false;function hideElement(c,d){if(ie){for(i=0;i<document.all.tags(c).length;i++){obj=document.all.tags(c)[i];if(!obj||!obj.offsetParent){continue}objLeft=obj.offsetLeft;objTop=obj.offsetTop;objParent=obj.offsetParent;while(objParent.tagName.toUpperCase()!="BODY"){objLeft+=objParent.offsetLeft;objTop+=objParent.offsetTop;objParent=objParent.offsetParent}objHeight=obj.offsetHeight;objWidth=obj.offsetWidth;if((d.offsetLeft+d.offsetWidth)<=objLeft){}else{if((d.offsetTop+d.offsetHeight)<=objTop){}else{if(d.offsetTop>=(objTop+objHeight)){}else{if(d.offsetLeft>=(objLeft+objWidth)){}else{obj.style.visibility="hidden"}}}}}}}function showElement(c){if(ie){for(i=0;i<document.all.tags(c).length;i++){obj=document.all.tags(c)[i];if(!obj||!obj.offsetParent){continue}obj.style.visibility=""}}}function HolidayRec(f,c,g,e){this.d=f;this.m=c;this.y=g;this.desc=e}var HolidaysCounter=0;var Holidays=new Array();function addHoliday(f,c,g,e){Holidays[HolidaysCounter++]=new HolidayRec(f,c,g,e)}if(dom){for(i=0;i<imgsrc.length;i++){img[i]=new Image;img[i].src=imgDir+imgsrc[i]}document.write("<div onclick='bShow=true' id='calendar' style='z-index:+999;position:absolute;visibility:hidden;'><table width="+((showWeekNumber==1)?225:220)+" bgcolor='#ffffff'><tr class='header'><td><table width='"+((showWeekNumber==1)?225:218)+"'><tr><td align=center style='padding:2px;font-family:arial; font-size:11px;' nowrap='nowrap'><font color='#ffffff'><B><span id='caption'></span></B></font></td><td align=right><a href='javascript:ClearCalendar()'><IMG SRC='"+imgDir+"clear.gif' WIDTH='15' HEIGHT='12' BORDER='0' ALT='"+clrdate+"'></a></td></tr></table></td></tr><tr><td style='padding:1px' bgcolor=#ffffff><span id='content'></span></td></tr>");if(showToday==1){document.write("<tr bgcolor=#C0C0C0><td style='padding:3px' align=center><span id='lblToday' class='anchor'></span></td></tr>")}document.write("</table></div><div id='selectMonth' style='z-index:+999;position:absolute;visibility:hidden;'></div><div id='selectYear' style='z-index:+999;position:absolute;visibility:hidden;'></div>")}function swapImage(d,c){if(ie){document.getElementById(d).setAttribute("src",imgDir+c)}}function init(){if(!ns4){if(!ie){yearNow+=1900}crossobj=(dom)?document.getElementById("calendar").style:ie?document.all.calendar:document.calendar;hideCalendar();crossMonthObj=(dom)?document.getElementById("selectMonth").style:ie?document.all.selectMonth:document.selectMonth;crossYearObj=(dom)?document.getElementById("selectYear").style:ie?document.all.selectYear:document.selectYear;monthConstructed=false;yearConstructed=false;if(showToday==1){document.getElementById("lblToday").innerHTML=todayString+" <a onmousemove='window.status=\""+gotoString+"\"' onmouseout='window.status=\"\"' title='"+gotoString+"' class='anchor' href='javascript:monthSelected=monthNow;yearSelected=yearNow;constructCalendar();'>"+dayName[(today.getDay()-startAt==-1)?6:(today.getDay()-startAt)]+", "+dateNow+" "+monthName[monthNow].substring(0,3)+"	"+yearNow+"</a>"}sHTML1='<span id=\'spanLeft\'	class=\'menu\' onmouseover=\'swapImage("changeLeft","left2.gif");this.style.borderColor="#88AAFF";window.status="'+scrollLeftMessage+"\"' onclick='javascript:decMonth()' onmouseout='clearInterval(intervalID1);swapImage(\"changeLeft\",\"left1.gif\");this.style.borderColor=\"#3366FF\";window.status=\"\"' onmousedown='clearTimeout(timeoutID1);timeoutID1=setTimeout(\"StartDecMonth()\",500)'	onmouseup='clearTimeout(timeoutID1);clearInterval(intervalID1)'>&nbsp<IMG id='changeLeft' SRC='"+imgDir+"left1.gif' width=10 height=11 BORDER=0 alt='<'>&nbsp</span>&nbsp;";sHTML1+='<span id=\'spanRight\' class=\'menu\'	onmouseover=\'swapImage("changeRight","right2.gif");this.style.borderColor="#88AAFF";window.status="'+scrollRightMessage+"\"' onmouseout='clearInterval(intervalID1);swapImage(\"changeRight\",\"right1.gif\");this.style.borderColor=\"#3366FF\";window.status=\"\"' onclick='incMonth()' onmousedown='clearTimeout(timeoutID1);timeoutID1=setTimeout(\"StartIncMonth()\",500)'	onmouseup='clearTimeout(timeoutID1);clearInterval(intervalID1)'>&nbsp<IMG id='changeRight' SRC='"+imgDir+"right1.gif'	width=10 height=11 BORDER=0 alt='>'>&nbsp</span>&nbsp";sHTML1+='<span id=\'spanMonth\' class=\'menu\'	onmouseover=\'swapImage("changeMonth","drop2.gif");this.style.borderColor="#88AAFF";window.status="'+selectMonthMessage+'"\' onmouseout=\'swapImage("changeMonth","drop1.gif");this.style.borderColor="#3366FF";window.status=""\' onclick=\'popUpMonth()\'></span>&nbsp;';sHTML1+='<span id=\'spanYear\' class=\'menu\' onmouseover=\'swapImage("changeYear","drop2.gif");this.style.borderColor="#88AAFF";window.status="'+selectYearMessage+'"\'	onmouseout=\'swapImage("changeYear","drop1.gif");this.style.borderColor="#3366FF";window.status=""\'	onclick=\'popUpYear()\'></span>&nbsp;';document.getElementById("caption").innerHTML=sHTML1;bPageLoaded=true}}function hideCalendar(){crossobj.visibility="hidden";if(crossMonthObj!=null){crossMonthObj.visibility="hidden"}if(crossYearObj!=null){crossYearObj.visibility="hidden"}showElement("SELECT");showElement("APPLET")}function padZero(c){return(c<10)?"0"+c:c}function constructDate(e,c,f){sTmp=dateFormat;sTmp=sTmp.replace("dd","<e>");sTmp=sTmp.replace("d","<d>");sTmp=sTmp.replace("<e>",padZero(e));sTmp=sTmp.replace("<d>",e);sTmp=sTmp.replace("mmmm","<p>");sTmp=sTmp.replace("mmm","<o>");sTmp=sTmp.replace("mm","<n>");sTmp=sTmp.replace("m","<m>");sTmp=sTmp.replace("<m>",c+1);sTmp=sTmp.replace("<n>",padZero(c+1));sTmp=sTmp.replace("<o>",monthName[c]);sTmp=sTmp.replace("<p>",monthName2[c]);sTmp=sTmp.replace("yyyy",f);return sTmp.replace("yy",padZero(f%100))}function closeCalendar(){var c;hideCalendar();ctlToPlaceValue.value=constructDate(dateSelected,monthSelected,yearSelected)}function ClearCalendar(){var c;hideCalendar();ctlToPlaceValue.value=""}function StartDecMonth(){intervalID1=setInterval("decMonth()",80)}function StartIncMonth(){intervalID1=setInterval("incMonth()",80)}function incMonth(){monthSelected++;if(monthSelected>11){monthSelected=0;yearSelected++}constructCalendar()}function decMonth(){monthSelected--;if(monthSelected<0){monthSelected=11;yearSelected--}constructCalendar()}function constructMonth(){popDownYear();if(!monthConstructed){sHTML="";for(i=0;i<12;i++){sName=monthName[i];if(i==monthSelected){sName="<B>"+sName+"</B>"}sHTML+="<tr class='menuitem'><td id='m"+i+"' onclick='monthConstructed=false;monthSelected="+i+";constructCalendar();popDownMonth();event.cancelBubble=true'>&nbsp;"+sName+"&nbsp;</td></tr>"}document.getElementById("selectMonth").innerHTML="<table width=70	cellspacing=0 onmouseover='clearTimeout(timeoutID1)'	onmouseout='clearTimeout(timeoutID1);timeoutID1=setTimeout(\"popDownMonth()\",100);event.cancelBubble=true'>"+sHTML+"</table>";monthConstructed=true}}function popUpMonth(){constructMonth();crossMonthObj.visibility=(dom||ie)?"visible":"show";crossMonthObj.left=parseInt(crossobj.left)+50;crossMonthObj.top=parseInt(crossobj.top)+26;hideElement("SELECT",document.getElementById("selectMonth"));hideElement("APPLET",document.getElementById("selectMonth"))}function popDownMonth(){crossMonthObj.visibility="hidden"}function incYear(){for(i=0;i<7;i++){newYear=(i+nStartingYear)+1;if(newYear==yearSelected){txtYear="&nbsp;<B>"+newYear+"</B>&nbsp;"}else{txtYear="&nbsp;"+newYear+"&nbsp;"}document.getElementById("y"+i).innerHTML=txtYear}nStartingYear++;bShow=true}function decYear(){for(i=0;i<7;i++){newYear=(i+nStartingYear)-1;if(newYear==yearSelected){txtYear="&nbsp;<B>"+newYear+"</B>&nbsp;"}else{txtYear="&nbsp;"+newYear+"&nbsp;"}document.getElementById("y"+i).innerHTML=txtYear}nStartingYear--;bShow=true}function selectYear(c){yearSelected=parseInt(c+nStartingYear);yearConstructed=false;constructCalendar();popDownYear()}function constructYear(){popDownMonth();sHTML="";if(!yearConstructed){sHTML="<tr class='menuitem'><td align='center' onmouseout='clearInterval(intervalID1);' onmousedown='clearInterval(intervalID1);intervalID1=setInterval(\"decYear()\",30)' onmouseup='clearInterval(intervalID1)'>-</td></tr>";j=0;nStartingYear=yearSelected-3;for(i=(yearSelected-3);i<=(yearSelected+3);i++){sName=i;if(i==yearSelected){sName="<B>"+sName+"</B>"}sHTML+="<tr class='menuitem'><td id='y"+j+"' onclick='selectYear("+j+");event.cancelBubble=true'>&nbsp;"+sName+"&nbsp;</td></tr>";j++}sHTML+="<tr class='menuitem'><td align='center' onmouseout='clearInterval(intervalID2);' onmousedown='clearInterval(intervalID2);intervalID2=setInterval(\"incYear()\",30)'	onmouseup='clearInterval(intervalID2)'>+</td></tr>";document.getElementById("selectYear").innerHTML="<table width=44 onmouseover='clearTimeout(timeoutID2)' onmouseout='clearTimeout(timeoutID2);timeoutID2=setTimeout(\"popDownYear()\",100)' cellspacing=0>"+sHTML+"</table>";yearConstructed=true}}function popDownYear(){clearInterval(intervalID1);clearTimeout(timeoutID1);clearInterval(intervalID2);clearTimeout(timeoutID2);crossYearObj.visibility="hidden"}function popUpYear(){var c;constructYear();crossYearObj.visibility=(dom||ie)?"visible":"show";c=parseInt(crossobj.left)+document.getElementById("spanYear").offsetLeft;if(ie){c+=6}crossYearObj.left=c;crossYearObj.top=parseInt(crossobj.top)+26}function WeekNbr(c){year=c.getFullYear();month=c.getMonth()+1;if(startAt==0){day=c.getDate()+1}else{day=c.getDate()}a=Math.floor((14-month)/12);y=year+4800-a;m=month+12*a-3;b=Math.floor(y/4)-Math.floor(y/100)+Math.floor(y/400);J=day+Math.floor((153*m+2)/5)+365*y+b-32045;d4=(((J+31741-(J%7))%146097)%36524)%1461;L=Math.floor(d4/1460);d1=((d4-L)%365)+L;week=Math.floor(d1/7)+1;return week}function constructCalendar(){var f=Array(31,0,31,30,31,30,31,31,30,31,30,31);var d;var c=new Date(yearSelected,monthSelected,1);var h;if(monthSelected==1){h=new Date(yearSelected,monthSelected+1,1);h=new Date(h-(24*60*60*1000));numDaysInMonth=h.getDate()}else{numDaysInMonth=f[monthSelected]}datePointer=0;dayPointer=c.getDay()-startAt;if(dayPointer<0){dayPointer=6}sHTML="<table	id='piwical' align='center' border=0 style='font-family:Arial;font-size:10px;' bgcolor='#f0f0f0'><TR> ";if(showWeekNumber==1){sHTML+="<td width='25'><b>"+weekString+"</b></td><td width=1 rowspan=7  style='padding:0px'><img src='"+imgDir+"divider.gif' width=1></td>"}for(e=0;e<7;e++){sHTML+="<td width='25' align='right'><B>"+dayName[e]+"</B></td>"}sHTML+="</tr><tr>";if(showWeekNumber==1){sHTML+="<td align=right class='week'>"+WeekNbr(c)+"&nbsp;</td>"}for(var e=1;e<=dayPointer;e++){sHTML+="<td>&nbsp;</td>"}for(datePointer=1;datePointer<=numDaysInMonth;datePointer++){dayPointer++;sHTML+="<td align=right>";sHint="";bflag=true;for(k=0;k<HolidaysCounter;k++){if((parseInt(Holidays[k].d)==datePointer)&&(parseInt(Holidays[k].m)==(monthSelected+1))){if((parseInt(Holidays[k].y)==0)||((parseInt(Holidays[k].y)==yearSelected)&&(parseInt(Holidays[k].y)!=0))){if(bflag){sHint+=sHint==""?Holidays[k].desc:"\n"+Holidays[k].desc;sHTML+="<a "+d+' title="'+sHint+"\" class='holiday' href='javascript:dateSelected="+datePointer+";closeCalendar();'>&nbsp;"+datePointer+"&nbsp;</a>";bflag=false}}}}var g=/\"/g;sHint=sHint.replace(g,"&quot;");d="onmousemove='window.status=\""+selectDateMessage.replace("[date]",constructDate(datePointer,monthSelected,yearSelected))+"\"' onmouseout='window.status=\"\"' ";if(bflag){if((datePointer==dateNow)&&(monthSelected==monthNow)&&(yearSelected==yearNow)){sHTML+="<b><a "+d+' title="'+sHint+"\" class='today' href='javascript:dateSelected="+datePointer+";closeCalendar();'>&nbsp;"+datePointer+"&nbsp;</a></b>"}else{if(dayPointer%7==(startAt*-1)+1){sHTML+="<a "+d+' title="'+sHint+"\" class='startday' href='javascript:dateSelected="+datePointer+";closeCalendar();'>&nbsp;"+datePointer+"&nbsp;</a>"}else{sHTML+="<a "+d+' title="'+sHint+"\" class='anyday' href='javascript:dateSelected="+datePointer+";closeCalendar();'>&nbsp;"+datePointer+"&nbsp;</a>"}}sHTML+="";if((dayPointer+startAt)%7==startAt){sHTML+="</tr><tr>";if((showWeekNumber==1)&&(datePointer<numDaysInMonth)){sHTML+="<td align=right class='week'>"+(WeekNbr(new Date(yearSelected,monthSelected,datePointer+1)))+"&nbsp;</td>"}}}}document.getElementById("content").innerHTML=sHTML;document.getElementById("spanMonth").innerHTML="&nbsp;"+monthName[monthSelected]+"&nbsp;<IMG id='changeMonth' SRC='"+imgDir+"drop1.gif' WIDTH='12' HEIGHT='10' BORDER=0>";document.getElementById("spanYear").innerHTML="&nbsp;"+yearSelected+"&nbsp;<IMG id='changeYear' SRC='"+imgDir+"drop1.gif' WIDTH='12' HEIGHT='10' BORDER=0>"}function popUpCalendar(c,l,h,e,d,n){var g=0;var f=0;(e)?showToday=1:showToday=0;(d)?showWeekNumber=1:showWeekNumber=0;(n)?startAt=1:startAt=0;if(bPageLoaded){if(crossobj.visibility=="hidden"){ctlToPlaceValue=l;dateFormat=h;formatChar=" ";aFormat=dateFormat.split(formatChar);if(aFormat.length<3){formatChar="/";aFormat=dateFormat.split(formatChar);if(aFormat.length<3){formatChar=".";aFormat=dateFormat.split(formatChar);if(aFormat.length<3){formatChar="-";aFormat=dateFormat.split(formatChar);if(aFormat.length<3){formatChar=""}}}}tokensChanged=0;if(formatChar!=""){aData=l.value.split(formatChar);for(i=0;i<3;i++){if((aFormat[i]=="d")||(aFormat[i]=="dd")){dateSelected=parseInt(aData[i],10);tokensChanged++}else{if((aFormat[i]=="m")||(aFormat[i]=="mm")){monthSelected=parseInt(aData[i],10)-1;tokensChanged++}else{if(aFormat[i]=="yyyy"){yearSelected=parseInt(aData[i],10);tokensChanged++}else{if(aFormat[i]=="mmm"){for(j=0;j<12;j++){if(aData[i]==monthName[j]){monthSelected=j;tokensChanged++}}}else{if(aFormat[i]=="mmmm"){for(j=0;j<12;j++){if(aData[i]==monthName2[j]){monthSelected=j;tokensChanged++}}}}}}}}}if((tokensChanged!=3)||isNaN(dateSelected)||isNaN(monthSelected)||isNaN(yearSelected)){dateSelected=dateNow;monthSelected=monthNow;yearSelected=yearNow}odateSelected=dateSelected;omonthSelected=monthSelected;oyearSelected=yearSelected;aTag=c;do{aTag=aTag.offsetParent;g+=aTag.offsetLeft;f+=aTag.offsetTop}while(aTag.tagName!="BODY");crossobj.left=fixedX==-1?c.offsetLeft+g:fixedX;crossobj.top=fixedY==-1?c.offsetTop+f+c.offsetHeight-195:fixedY;constructCalendar(1,monthSelected,yearSelected);crossobj.visibility=(dom||ie)?"visible":"show";hideElement("SELECT",document.getElementById("calendar"));hideElement("APPLET",document.getElementById("calendar"));bShow=true}else{hideCalendar();if(ctlNow!=c){popUpCalendar(c,l,h)}}ctlNow=c}}document.onkeypress=function hidecal1(){hideCalendar()};document.onclick=function hidecal2(){if(!bShow){hideCalendar()}bShow=false};if(ie){init()}else{window.onload=init};