<!-- BEGIN compose -->
{alerts}
<div class="gadget privateMessage message" id="compose">
    <h2>{title}</h2>

    <div id="simple_response" class="{response_type}">{response}</div>

    <form name="contacts" action="{base_script}" method="post" enctype="multipart/form-data">
        <input type="hidden" value="15000000" id="MAX_FILE_SIZE" name="MAX_FILE_SIZE">
        <input type="hidden" name="gadget" value="PrivateMessage"/>
        <input type="hidden" name="action" value="ComposeMessage"/>
        <input type="hidden" name="id" id="id" value="{id}"/>
        <input type="hidden" name="parent" id="parent" value="{parent}"/>

        <div class="content">
            <div>
                <label for="recipient_users">{lbl_recipient_users}:</label>
                <input name="recipient_users" id="recipient_users" type="text" value="{recipient_users}"/>
            </div>

            <div>
                <label for="recipient_groups">{lbl_recipient_groups}:</label>
                <input name="recipient_groups" id="recipient_groups" type="text" value="{recipient_groups}"/>
            </div>

            <div>
                <label for="subject">{lbl_subject}:</label>
                <input name="subject" id="subject" type="text" value="{subject}"/>
            </div>

            <div>
                <label for="body">{lbl_body}:</label>
                {body}
            </div>
        </div>
    </form>

    <form id="frm_file" name="frm_file" method="post" target="ifrm_upload" action="{base_script}"
          enctype="multipart/form-data" onsubmit="return true">
        <input type="hidden" name="gadget" value="PrivateMessage"/>
        <input type="hidden" name="action" value="UploadFile"/>
        <input type="hidden" name="attachment_number" id="attachment_number" value="1"/>
        <fieldset>
            <legend id="legend_attachments" toggle-status="max">
                <span>
                    <img alt="toggle attachments maximize" src="{icon_remove}">
                    {lbl_attachments}
                </span>
            </legend>

            <!-- BEGIN file -->
            <div>
                <input type="checkbox" name="selected_files[]" id="chk_file_{file_id}" value="{file_id}"
                       checked>
                <a href="{file_download_link}">{file_name}</a> ({lbl_file_size}: {file_size})
            </div>
            <!-- END file -->

            <div class="attach_actions" id="attachment_area">
                <img id="attach_loading" src="images/loading.gif"/>

                <div id="btn_attach1">
                    <img src="gadgets/Contact/images/attachment.png"/>
                    <a id="file_link1"></a> -
                    <small id="file_size1"></small>
                    <a onclick="javascript:removeAttachment(1);" href="javascript:void(0);"><img border="0"
                                                                                                title="Remove"
                                                                                                alt="Remove"
                                                                                                src="images/stock/cancel.png"></a>
                </div>
                    <input type="file" onchange="uploadFile();" id="attachment1" name="attachment1" size="1"
                           style="display: block;">

                <span id="attachment_addentry2">
                </span>
            </div>
        </fieldset>
    </form>

</div>

<div class="actions">
    <a href="{back_url}" class="button" id="btn_back">{lbl_back}</a>
    <a class="button" href="javascript:sendMessage(false)" id="btn_save_draft">{lbl_save_draft}</a>
    <a class="button" href="javascript:sendMessage(true)" id="btn_send">{lbl_send}</a>
</div>
<!--</div>-->

<script type="text/javascript">
    $('attachment1').show();
    $('attach_loading').hide();
    $('btn_attach1').hide();

    var toggleMax = "{icon_add}";
    var toggleMin = "{icon_remove}";
    $('attachment_area').toggle();

    function ChangeToggleIcon(obj)
    {
        if ($(obj).get('toggle-status') == 'min') {
            $(obj).getElementsByTagName('img')[0].src = toggleMin;
            $(obj).set('toggle-status', 'max');
        } else {
            $(obj).getElementsByTagName('img')[0].src = toggleMax;
            $(obj).set('toggle-status', 'min');
        }
    }

    window.addEvent('domready', function() {

        $('legend_attachments').addEvent('click', function(){
            $('attachment_area').toggle();
            ChangeToggleIcon(this);
        });
    });


    //    $('recipient_users').addEvent('keypress',function(e) {
//        console.log(getUsers($('recipient_users').value));
//    });
//
//    $('recipient_groups').addEvent('keypress',function(e) {
//        console.log(getGroups($('recipient_groups').value));
//    });

</script>

<!-- END compose -->
